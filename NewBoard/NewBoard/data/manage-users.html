<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manajemen Pengguna</title>
  <!-- <link rel="stylesheet" href="style.css"> -->
  <style>
    /* General Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Open Sans', sans-serif;
      background: linear-gradient(135deg, #545454, #d8d8d8);
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-family: 'Open Sans', sans-serif;
      font-size: 1.2rem;
      font-weight: bold;
      text-align: left;
    }

    /* Navigation Bar Styles */
    nav {
      width: 100%;
      background: linear-gradient(90deg, #ffffff, #7ed856);
      padding: 1rem 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .nav-container {
      max-width: auto;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 1rem;
    }

    .brand {
      color: #000000;
      text-decoration: none;
      font-size: 1.8rem;
      font-weight: bold;
    }

    .nav-menu {
      list-style-type: none;
      display: flex;
    }

    .nav-menu li {
      margin-left: 2rem;
    }

    .nav-menu a {
      color: #000000;
      text-decoration: none;
      font-size: 1rem;
      font-weight: bold;
      transition: color 0.3s;
      margin-right: .2rem;
    }

    .nav-menu a:hover,
    .nav-menu a.active {
      color: #e74c3c;
      font-weight: bold;
    }

    .nav-logo {
      height: 40px;
      /* width: 600px; */
      /* margin-right: 4px; */
      vertical-align: middle;
    }

    .nav-icon-inline {
      height: 1em;
      vertical-align: middle;
      margin-left: 4px;
    }

    /* Main Container & Section Styles */
    .main-container {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-grow: 1;
      width: 100%;
      padding: 5rem 1rem;
    }

    .main-section {
      /* width: 40%; */
      /* height: 50%; */
      /* max-height: auto; */
      max-width: auto;
      padding: 1rem;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .main-section h2 {
      margin-bottom: 1.5rem;
      color: #000000;
    }

    /* Table Styles */
    #tableData {
      font-family: 'Open Sans', sans-serif;
      border-collapse: collapse;
      width: auto;
      /* Ubah dari 100% menjadi auto */
      margin: 1rem auto;
      /* Margin atas dan bawah 2rem, kiri dan kanan auto agar tabel berada di tengah */
      table-layout: auto;
      /* Gunakan layout otomatis agar lebar kolom menyesuaikan isi */
    }

    #tableData td,
    #tableData th {
      /* border: 1px solid #ddd;
      padding: 12px 15px;
      text-align: left; */
      border: 1.5px solid #808080;
      padding: 6.3px 15px;
      text-align: left;
    }

    #tableData tr:nth-child(even) {
      background-color: #f7f7f7;
    }

    #tableData tr:hover {
      background-color: #f1f1f1;
    }

    #tableData th {
      background-color: #7ed856;
      color: #000000;
      font-weight: 600;
      text-align: center;
    }

    /* Button Styles */
    .button {
      display: inline-block;
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .button-delete {
      background-color: #e74c3c;
      color: #000000;
    }

    .button-delete:hover {
      background: #34495e;
      color: #fff
    }

    .button-home {
      background-color: #2c3e50;
      color: #fff;
    }

    .button-home:hover {
      background: #34495e;
      color: #fff
    }

    /* Form Styles */
    .user-form label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #000000;
      text-align: left;
    }

    .user-form input,
    .user-form select {
      width: 100%;
      padding: 0.7rem;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
    }

    .user-form button {
      width: 100%;
      padding: 0.8rem;
      background-color: #2c3e50;
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .user-form button:hover {
      background-color: #34495e;
    }
  </style>
</head>

<body>
  <nav>
    <div class="nav-container">
      <!-- <a href="/" class="brand">RFID Door Lock Access</a> -->
       <img src="/img/logo.png" alt="Logo" class="nav-logo">
      <ul class="nav-menu">
        <li><a href="full-log">üìÑ Semua Log</a></li>
        <li><a href="add-user">‚ûï Tambahkan Pengguna</a></li>
        <li><a href="manage-users" class="active">üë§ Kelola Pengguna</a></li>
        <li><a href="configuration">‚öôÔ∏è Configuration</a></li>
      </ul>
    </div>
  </nav>
  <div class="main-container">
    <section class="main-section">
      <h2>üë§ Log Pengguna</h2>
      <table id="tableData">
        <thead>
          <tr>
            <th>UID</th>
            <th>Role</th>
            <th>Nama</th>
            <th>Hapus</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data from users.txt will be loaded here -->
        </tbody>
      </table>
      <a href="/download/users.txt"><button class="button button-delete">üíæ Unduh File</button></a>
      <a href="get?delete=users"><button class="button button-delete">üóëÔ∏è Hapus File</button></a>
    </section>
  </div>
  <script>
    // JavaScript to load and parse users.txt
    async function loadTableData() {
      try {
        const response = await fetch('view-users');
        const data = await response.text();
        const rows = data.trim().split('\n').slice(1); // Skip the header line

        const tableBody = document.querySelector('#tableData tbody');
        rows.forEach((row, index) => {
          const columns = row.split(',');
          const tr = document.createElement('tr');
          // Add remaining columns
          columns.forEach(column => {
            const td = document.createElement('td');
            td.textContent = column;
            tr.appendChild(td);
          });
          // Create and add row number cell with a delete link
          const noCell = document.createElement('td');
          const deleteLink = document.createElement('a');
          deleteLink.href = `get?delete-user=${index + 1}`;
          deleteLink.textContent = "‚ùå #" + (index + 1);
          noCell.appendChild(deleteLink);
          tr.appendChild(noCell);

          tableBody.appendChild(tr);
        });
      } catch (error) {
        console.error('Error loading log data:', error);
      }
    }
    // Call the function to load log data
    loadTableData();
  </script>
</body>

</html>